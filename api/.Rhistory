sysndd_db_disease_gene_statistics <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1) %>%
select(symbol, hpo_mode_of_inheritance_term_name, category) %>%
collect() %>%
unique() %>%
mutate(hpo_mode_of_inheritance_term_name = case_when(
str_detect(hpo_mode_of_inheritance_term_name, "X-linked") ~ "X-linked",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal dominant inheritance") ~ "Dominant",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal recessive  inheritance") ~ "Recessive",
TRUE ~ "other"
)) %>%
group_by(category, hpo_mode_of_inheritance_term_name) %>%
tally() %>%
arrange(desc(category), hpo_mode_of_inheritance_term_name, n)
sysndd_db_disease_gene_statistics <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1) %>%
select(symbol, hpo_mode_of_inheritance_term_name, category) %>%
collect() %>%
unique() %>%
mutate(hpo_mode_of_inheritance_term_name = case_when(
str_detect(hpo_mode_of_inheritance_term_name, "X-linked") ~ "X-linked",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal dominant inheritance") ~ "Dominant",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal recessive inheritance") ~ "Recessive",
TRUE ~ "other"
)) %>%
group_by(category, hpo_mode_of_inheritance_term_name) %>%
tally() %>%
arrange(desc(category), hpo_mode_of_inheritance_term_name, n)
sysndd_db_disease_gene_statistics <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1) %>%
select(symbol, hpo_mode_of_inheritance_term_name, category) %>%
collect() %>%
unique() %>%
mutate(hpo_mode_of_inheritance_term_name = case_when(
str_detect(hpo_mode_of_inheritance_term_name, "X-linked") ~ "X-linked",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal dominant inheritance") ~ "Dominant",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal recessive inheritance") ~ "Recessive",
TRUE ~ "Other"
)) %>%
group_by(category, hpo_mode_of_inheritance_term_name) %>%
tally() %>%
arrange(desc(category), hpo_mode_of_inheritance_term_name, n)
sysndd_db_disease_gene_statistics <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1) %>%
select(symbol, hpo_mode_of_inheritance_term_name, category) %>%
collect() %>%
unique() %>%
mutate(hpo_mode_of_inheritance_term_name = case_when(
str_detect(hpo_mode_of_inheritance_term_name, "X-linked") ~ "X-linked",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal dominant inheritance") ~ "Dominant",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal recessive inheritance") ~ "Recessive",
TRUE ~ "Other"
)) %>%
group_by(category, hpo_mode_of_inheritance_term_name) %>%
tally() %>%
arrange(desc(category), n)
sysndd_db_disease_gene_statistics <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1) %>%
select(symbol, hpo_mode_of_inheritance_term_name, category) %>%
collect() %>%
unique() %>%
mutate(hpo_mode_of_inheritance_term_name = case_when(
str_detect(hpo_mode_of_inheritance_term_name, "X-linked") ~ "X-linked",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal dominant inheritance") ~ "Dominant",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal recessive inheritance") ~ "Recessive",
TRUE ~ "Other"
)) %>%
group_by(category, hpo_mode_of_inheritance_term_name) %>%
tally() %>%
arrange(desc(category), desc(n))
sysndd_db_disease_gene_statistics <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1) %>%
select(symbol, hpo_mode_of_inheritance_term_name, category) %>%
collect() %>%
unique() %>%
mutate(hpo_mode_of_inheritance_term_name = case_when(
str_detect(hpo_mode_of_inheritance_term_name, "X-linked") ~ "X-linked",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal dominant inheritance") ~ "Dominant",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal recessive inheritance") ~ "Recessive",
TRUE ~ "Other"
)) %>%
group_by(category, hpo_mode_of_inheritance_term_name) %>%
tally() %>%
ungroup() %>%
arrange(desc(category), desc(n)) %>%
group_by(category) %>%
mutate(cum_sep_len = cumsum(Sepal.Length))
sysndd_db_disease_gene_statistics <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1) %>%
select(symbol, hpo_mode_of_inheritance_term_name, category) %>%
collect() %>%
unique() %>%
mutate(hpo_mode_of_inheritance_term_name = case_when(
str_detect(hpo_mode_of_inheritance_term_name, "X-linked") ~ "X-linked",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal dominant inheritance") ~ "Dominant",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal recessive inheritance") ~ "Recessive",
TRUE ~ "Other"
)) %>%
group_by(category, hpo_mode_of_inheritance_term_name) %>%
tally() %>%
ungroup() %>%
arrange(desc(category), desc(n)) %>%
group_by(category) %>%
mutate(cum_sep_len = cumsum(n))
sysndd_db_disease_genes <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1) %>%
select(symbol, hpo_mode_of_inheritance_term_name, category) %>%
collect() %>%
unique()y), desc(n)) %>%
group_by(category)
sysndd_db_disease_genes <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1) %>%
select(symbol, hpo_mode_of_inheritance_term_name, category) %>%
collect() %>%
unique()
sysndd_db_disease_genes_grouped_by_inheritance <- sysndd_db_disease_genes %>%
mutate(hpo_mode_of_inheritance_term_name = case_when(
str_detect(hpo_mode_of_inheritance_term_name, "X-linked") ~ "X-linked",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal dominant inheritance") ~ "Dominant",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal recessive inheritance") ~ "Recessive",
TRUE ~ "Other"
)) %>%
group_by(category, hpo_mode_of_inheritance_term_name) %>%
tally() %>%
ungroup() %>%
arrange(desc(category), desc(n)) %>%
group_by(category)
View(sysndd_db_disease_genes_grouped_by_inheritance)
sysndd_db_disease_genes_grouped_by_category_and_inheritance <- sysndd_db_disease_genes %>%
mutate(hpo_mode_of_inheritance_term_name = case_when(
str_detect(hpo_mode_of_inheritance_term_name, "X-linked") ~ "X-linked",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal dominant inheritance") ~ "Dominant",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal recessive inheritance") ~ "Recessive",
TRUE ~ "Other"
)) %>%
group_by(category, hpo_mode_of_inheritance_term_name) %>%
tally() %>%
ungroup() %>%
arrange(desc(category), desc(n)) %>%
group_by(category)
sysndd_db_disease_genes_grouped_by_category <- sysndd_db_disease_genes %>%
mutate(hpo_mode_of_inheritance_term_name = case_when(
str_detect(hpo_mode_of_inheritance_term_name, "X-linked") ~ "X-linked",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal dominant inheritance") ~ "Dominant",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal recessive inheritance") ~ "Recessive",
TRUE ~ "Other"
)) %>%
group_by(category) %>%
tally()
View(sysndd_db_disease_genes_grouped_by_category)
sysndd_db_disease_genes <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1) %>%
select(symbol, hpo_mode_of_inheritance_term_name, category) %>%
collect()
sysndd_db_disease_genes_grouped_by_category_and_inheritance <- sysndd_db_disease_genes %>%
unique() %>%
mutate(hpo_mode_of_inheritance_term_name = case_when(
str_detect(hpo_mode_of_inheritance_term_name, "X-linked") ~ "X-linked",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal dominant inheritance") ~ "Dominant",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal recessive inheritance") ~ "Recessive",
TRUE ~ "Other"
)) %>%
group_by(category, hpo_mode_of_inheritance_term_name) %>%
tally() %>%
ungroup() %>%
arrange(desc(category), desc(n)) %>%
group_by(category)
View(sysndd_db_disease_genes_grouped_by_category_and_inheritance )
sysndd_db_disease_genes %>%
select(-hpo_mode_of_inheritance_term_name)
sysndd_db_disease_genes_grouped_by_category <- sysndd_db_disease_genes %>%
select(-hpo_mode_of_inheritance_term_name) %>%
group_by(category) %>%
tally()
View(sysndd_db_disease_genes_grouped_by_category )
sysndd_db_disease_genes_grouped_by_category <- sysndd_db_disease_genes %>%
select(-hpo_mode_of_inheritance_term_name) %>%
unique() %>%
group_by(category) %>%
tally()
sysndd_db_disease_genes_grouped_by_category <- sysndd_db_disease_genes %>%
select(-hpo_mode_of_inheritance_term_name) %>%
unique() %>%
group_by(category) %>%
tally() %>%
ungroup() %>%
arrange(desc(category), desc(n))
sysndd_db_disease_genes_grouped_by_category_and_inheritance <- sysndd_db_disease_genes %>%
unique() %>%
mutate(hpo_mode_of_inheritance_term_name = case_when(
str_detect(hpo_mode_of_inheritance_term_name, "X-linked") ~ "X-linked",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal dominant inheritance") ~ "Dominant",
str_detect(hpo_mode_of_inheritance_term_name, "Autosomal recessive inheritance") ~ "Recessive",
TRUE ~ "Other"
)) %>%
group_by(category, hpo_mode_of_inheritance_term_name) %>%
tally() %>%
ungroup() %>%
arrange(desc(category), desc(n))
sysndd_db_disease_genes <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1) %>%
select(symbol, inheritance = hpo_mode_of_inheritance_term_name, category) %>%
collect()
sysndd_db_disease_genes_grouped_by_category_and_inheritance <- sysndd_db_disease_genes %>%
unique() %>%
mutate(inheritance = case_when(
str_detect(inheritance, "X-linked") ~ "X-linked",
str_detect(inheritance, "Autosomal dominant inheritance") ~ "Dominant",
str_detect(inheritance, "Autosomal recessive inheritance") ~ "Recessive",
TRUE ~ "Other"
)) %>%
group_by(category, inheritance) %>%
tally() %>%
ungroup() %>%
arrange(desc(category), desc(n))
View(sysndd_db_disease_genes_grouped_by_category_and_inheritance)
sysndd_db_disease_genes_grouped_by_category <- sysndd_db_disease_genes %>%
select(-inheritance) %>%
unique() %>%
group_by(category) %>%
tally() %>%
ungroup() %>%
arrange(desc(category), desc(n)) %>%
group_by(category)
sysndd_db_disease_genes_grouped_by_category
sysndd_db_disease_genes_grouped_by_category <- sysndd_db_disease_genes %>%
select(-inheritance) %>%
unique() %>%
group_by(category) %>%
tally() %>%
ungroup() %>%
arrange(desc(category), desc(n)) %>%
group_by(category) %>%
mutate(inheritance = "all")
View(sysndd_db_disease_genes_grouped_by_category)
View(sysndd_db_disease_genes)
View(sysndd_db_disease_genes %>%
select(-inheritance))
View(sysndd_db_disease_genes %>%
select(-inheritance) %>%
unique())
bind_rows(list(sysndd_db_disease_genes_grouped_by_category_and_inheritance, sysndd_db_disease_genes_grouped_by_category))
sysndd_db_disease_genes_statistics <- bind_rows(list(sysndd_db_disease_genes_grouped_by_category_and_inheritance, sysndd_db_disease_genes_grouped_by_category)) %>%
arrange(desc(category), desc(n))
View(sysndd_db_disease_genes_statistics)
sysndd_db_disease_genes_grouped_by_category <- sysndd_db_disease_genes %>%
select(-inheritance) %>%
unique() %>%
group_by(category) %>%
tally() %>%
ungroup() %>%
arrange(desc(category), desc(n)) %>%
group_by(category) %>%
mutate(inheritance = "All")
sysndd_db_disease_genes_statistics <- bind_rows(list(sysndd_db_disease_genes_grouped_by_category_and_inheritance, sysndd_db_disease_genes_grouped_by_category)) %>%
arrange(desc(category), desc(n))
sysndd_db_disease_genes <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1) %>%
select(symbol, inheritance = hpo_mode_of_inheritance_term_name, category) %>%
collect()
View(sysndd_db_disease_genes )
sysndd_db_disease_genes <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1) %>%
collect()
sysndd_db_disease_genes <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1 & category == "Definitive") %>%
collect()
sysndd_db_disease_genes <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1 & category == "Definitive") %>%
arrange(desc(entry_date))
collect()
sysndd_db_disease_genes <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1 & category == "Definitive") %>%
arrange(desc(entry_date)) %>%
collect()
sysndd_db_disease_genes <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1 & category == "Definitive") %>%
arrange(desc(entry_date)) %>%
top_n(5) %>%
collect()
sysndd_db_disease_genes <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1 & category == "Definitive") %>%
arrange(desc(entry_date)) %>%
collect() %>%
top_n(5)
sysndd_db_disease_genes <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1 & category == "Definitive") %>%
arrange(desc(entry_date)) %>%
collect()
sysndd_db_disease_genes <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1 & category == "Definitive") %>%
collect() %>%
arrange(desc(entry_date))
sysndd_db_disease_genes <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1 & category == "Definitive") %>%
collect() %>%
arrange(desc(entry_date))
sysndd_db_disease_genes <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1 & category == "Definitive") %>%
collect() %>%
arrange(desc(entry_date)) %>%
top_n(5)
sysndd_db_disease_genes <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1 & category == "Definitive") %>%
collect() %>%
arrange(desc(entry_date)) %>%
slice(1:5)
n <- 5
sysndd_db_disease_genes_news <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1 & category == "Definitive") %>%
collect() %>%
arrange(desc(entry_date)) %>%
slice(1:n)
sysndd_db <- dbConnect(RMariaDB::MariaDB(), dbname = dw$dbname, user = dw$user, password = dw$password, server = dw$server, host = dw$host, port = dw$port)
sysndd_db_disease_genes <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1) %>%
select(symbol, inheritance = hpo_mode_of_inheritance_term_name, category) %>%
collect()
sysndd_db_disease_genes <- tbl(sysndd_db, "ndd_entity_view") %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1) %>%
collect()
?tbl
sysndd_db_ndd_entity_view <- tbl(sysndd_db, "ndd_entity_view")
sysndd_db_non_alt_loci_set <- tbl(sysndd_db, "non_alt_loci_set")
View(sysndd_db_ndd_entity_view )
sysndd_db_disease_genes <- sysndd_db_ndd_entity_view %>%
left_join(sysndd_db_non_alt_loci_set, by =c("hgnc_id")) %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1) %>%
collect()
sysndd_db_disease_genes
sysndd_db_ndd_entity_view <- tbl(sysndd_db, "ndd_entity_view")
sysndd_db_non_alt_loci_set <- tbl(sysndd_db, "non_alt_loci_set") %>%
select(-symbol)
sysndd_db_disease_genes <- sysndd_db_ndd_entity_view %>%
left_join(sysndd_db_non_alt_loci_set, by =c("hgnc_id")) %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1) %>%
collect()
sysndd_db_ndd_entity_view <- tbl(sysndd_db, "ndd_entity_view")
sysndd_db_non_alt_loci_set <- tbl(sysndd_db, "non_alt_loci_set") %>%
select(hgnc_id, entrez_id, ensembl_gene_id, ucsc_id, ccds_id, uniprot_ids)
sysndd_db_disease_genes <- sysndd_db_ndd_entity_view %>%
left_join(sysndd_db_non_alt_loci_set, by =c("hgnc_id")) %>%
arrange(entity_id) %>%
filter(ndd_phenotype == 1) %>%
collect()
sysndd_db_ndd_entity_view <- tbl(sysndd_db, "ndd_entity_view") %>%
filter(ndd_phenotype == 1) %>%
select(symbol, inheritance = hpo_mode_of_inheritance_term_name, category)
sysndd_db_non_alt_loci_set <- tbl(sysndd_db, "non_alt_loci_set") %>%
select(hgnc_id, entrez_id, ensembl_gene_id, ucsc_id, ccds_id, uniprot_ids)
sysndd_db_disease_genes <- sysndd_db_ndd_entity_view %>%
left_join(sysndd_db_non_alt_loci_set, by =c("hgnc_id")) %>%
arrange(entity_id) %>%
collect()
sysndd_db_ndd_entity_view <- tbl(sysndd_db, "ndd_entity_view") %>%
filter(ndd_phenotype == 1) %>%
select(hgnc_id, symbol, inheritance = hpo_mode_of_inheritance_term_name, category)
sysndd_db_non_alt_loci_set <- tbl(sysndd_db, "non_alt_loci_set") %>%
select(hgnc_id, entrez_id, ensembl_gene_id, ucsc_id, ccds_id, uniprot_ids)
sysndd_db_disease_genes <- sysndd_db_ndd_entity_view %>%
left_join(sysndd_db_non_alt_loci_set, by =c("hgnc_id")) %>%
arrange(entity_id) %>%
collect()
sysndd_db_ndd_entity_view <- tbl(sysndd_db, "ndd_entity_view") %>%
filter(ndd_phenotype == 1) %>%
select(hgnc_id, symbol, inheritance = hpo_mode_of_inheritance_term_name, category)
sysndd_db_non_alt_loci_set <- tbl(sysndd_db, "non_alt_loci_set") %>%
select(hgnc_id, entrez_id, ensembl_gene_id, ucsc_id, ccds_id, uniprot_ids)
sysndd_db_disease_genes <- sysndd_db_ndd_entity_view %>%
left_join(sysndd_db_non_alt_loci_set, by =c("hgnc_id")) %>%
collect()
sysndd_db_ndd_entity_view <- tbl(sysndd_db, "ndd_entity_view") %>%
filter(ndd_phenotype == 1) %>%
select(hgnc_id, symbol, inheritance = hpo_mode_of_inheritance_term_name, category)
sysndd_db_non_alt_loci_set <- tbl(sysndd_db, "non_alt_loci_set") %>%
select(hgnc_id, entrez_id, ensembl_gene_id, ucsc_id, uniprot_ids)
sysndd_db_disease_genes <- sysndd_db_ndd_entity_view %>%
left_join(sysndd_db_non_alt_loci_set, by =c("hgnc_id")) %>%
collect()
sysndd_db_ndd_entity_view <- tbl(sysndd_db, "ndd_entity_view") %>%
filter(ndd_phenotype == 1) %>%
select(hgnc_id, symbol, inheritance = hpo_mode_of_inheritance_term_name, category)
sysndd_db_non_alt_loci_set <- tbl(sysndd_db, "non_alt_loci_set") %>%
select(hgnc_id, entrez_id, ensembl_gene_id, ucsc_id, uniprot_ids)
sysndd_db_disease_genes <- sysndd_db_ndd_entity_view %>%
left_join(sysndd_db_non_alt_loci_set, by =c("hgnc_id")) %>%
collect() %>%
unique()
sysndd_db_disease_genes <- sysndd_db_ndd_entity_view %>%
left_join(sysndd_db_non_alt_loci_set, by =c("hgnc_id")) %>%
collect() %>%
unique() %>%
mutate(inheritance = case_when(
str_detect(inheritance, "X-linked") ~ "X-linked",
str_detect(inheritance, "Autosomal dominant inheritance") ~ "Dominant",
str_detect(inheritance, "Autosomal recessive inheritance") ~ "Recessive",
TRUE ~ "Other"
))
sysndd_db_ndd_entity_view <- tbl(sysndd_db, "ndd_entity_view") %>%
filter(ndd_phenotype == 1) %>%
select(hgnc_id, symbol, inheritance = hpo_mode_of_inheritance_term_name, category)
sysndd_db_non_alt_loci_set <- tbl(sysndd_db, "non_alt_loci_set") %>%
select(hgnc_id, entrez_id, ensembl_gene_id, ucsc_id)
sysndd_db_disease_genes <- sysndd_db_ndd_entity_view %>%
left_join(sysndd_db_non_alt_loci_set, by =c("hgnc_id")) %>%
collect() %>%
unique() %>%
mutate(inheritance = case_when(
str_detect(inheritance, "X-linked") ~ "X-linked",
str_detect(inheritance, "Autosomal dominant inheritance") ~ "Dominant",
str_detect(inheritance, "Autosomal recessive inheritance") ~ "Recessive",
TRUE ~ "Other"
))
sysndd_db_disease_genes <- sysndd_db_ndd_entity_view %>%
left_join(sysndd_db_non_alt_loci_set, by =c("hgnc_id")) %>%
collect() %>%
unique() %>%
mutate(inheritance = case_when(
str_detect(inheritance, "X-linked") ~ "X-linked",
str_detect(inheritance, "Autosomal dominant inheritance") ~ "Dominant",
str_detect(inheritance, "Autosomal recessive inheritance") ~ "Recessive",
TRUE ~ "Other"
)) %>%
select(inheritance, category, symbol, hgnc_id, entrez_id, ensembl_gene_id, ucsc_id)
sysndd_db_disease_genes <- sysndd_db_ndd_entity_view %>%
left_join(sysndd_db_non_alt_loci_set, by =c("hgnc_id")) %>%
collect() %>%
unique() %>%
mutate(inheritance = case_when(
str_detect(inheritance, "X-linked") ~ "X-linked",
str_detect(inheritance, "Autosomal dominant inheritance") ~ "Dominant",
str_detect(inheritance, "Autosomal recessive inheritance") ~ "Recessive",
TRUE ~ "Other"
)) %>%
select(category, inheritance, symbol, hgnc_id, entrez_id, ensembl_gene_id, ucsc_id)
sysndd_db_disease_genes <- sysndd_db_ndd_entity_view %>%
left_join(sysndd_db_non_alt_loci_set, by =c("hgnc_id")) %>%
collect() %>%
unique() %>%
mutate(inheritance = case_when(
str_detect(inheritance, "X-linked") ~ "X-linked",
str_detect(inheritance, "Autosomal dominant inheritance") ~ "Dominant",
str_detect(inheritance, "Autosomal recessive inheritance") ~ "Recessive",
TRUE ~ "Other"
)) %>%
select(category, inheritance, symbol, hgnc_id, entrez_id, ensembl_gene_id, ucsc_id) %>%
arrange(desc(category), desc(n))
sysndd_db_disease_genes <- sysndd_db_ndd_entity_view %>%
left_join(sysndd_db_non_alt_loci_set, by =c("hgnc_id")) %>%
collect() %>%
unique() %>%
mutate(inheritance = case_when(
str_detect(inheritance, "X-linked") ~ "X-linked",
str_detect(inheritance, "Autosomal dominant inheritance") ~ "Dominant",
str_detect(inheritance, "Autosomal recessive inheritance") ~ "Recessive",
TRUE ~ "Other"
)) %>%
select(category, inheritance, symbol, hgnc_id, entrez_id, ensembl_gene_id, ucsc_id) %>%
arrange(desc(category), desc(inheritance))
sysndd_db_disease_genes <- sysndd_db_ndd_entity_view %>%
left_join(sysndd_db_non_alt_loci_set, by =c("hgnc_id")) %>%
collect() %>%
unique() %>%
mutate(inheritance = case_when(
str_detect(inheritance, "X-linked") ~ "X-linked",
str_detect(inheritance, "Autosomal dominant inheritance") ~ "Dominant",
str_detect(inheritance, "Autosomal recessive inheritance") ~ "Recessive",
TRUE ~ "Other"
)) %>%
select(category, inheritance, symbol, hgnc_id, entrez_id, ensembl_gene_id, ucsc_id) %>%
arrange(desc(category), inheritance)
sysndd_db_disease_genes %>%
filter(category = category, inheritance = inheritance) %>%
arrange(symbol)
category = "Definitive", inheritance = "Dominant"
category = "Definitive"; inheritance = "Dominant"
sysndd_db_disease_genes_panel <- sysndd_db_disease_genes %>%
filter(category == category, inheritance == inheritance) %>%
arrange(symbol)
View(sysndd_db_disease_genes_panel )
cat = "Definitive"; inh = "Dominant"
sysndd_db_disease_genes_panel <- sysndd_db_disease_genes %>%
filter(category == cat, inheritance == inh) %>%
arrange(symbol)
